<%- include('partials/header.ejs'); -%>

    <ul>
        <% if(messages.success_msg) { %>
        <li><%= messages.success_msg %></li>
        <% } %>
      </ul>

      <ul>
        <% if(typeof errors != 'undefined') { %>
             <% errors.forEach(error => { %>
                <li><%= error.message %></li>
           <%   }); %>
        
        <% } %>
      </ul>
      

    <div class="container">
        <div class="forms-container">
            <div class="signin-signup">
                
                <!-- Sign in form / Login-->
                <form action="/business/login" class="sign-in-form" method="post">
                    <h2 class="title">Sign in Admin</h2>
                    <div class="input-field">
                        <i class="bi bi-person"></i>
                        <input type="email" placeholder="Business Email" id="email" name="email" required>
                    </div>
                    <div class="input-field">
                        <i class="bi bi-lock"></i>
                        <input type="password" placeholder="password" id="password" name="password" required>
                        <i class="bi bi-eye-slash password-toggle" data-target="password"></i>
                    </div>
                    <input type="submit" value="Login" class="btn solid">
                    
                    <p class="social-text">Or Sign in with google</p>
                    <div class="social-media">
                        <a href="#" class="social-icon">
                            <i class="bi bi-google"></i>
                        </a>
                    </div>
                    <a href="/business/register">register here</a>
                </form>
                     
                        <%#Business Register form %>
                <form action="/business/register" class="sign-up-business-form" method="post">
                    <h2 class="title">Sign up</h2>
                    <div class="input-field">
                        <i class="bi bi-briefcase"></i>
                        <input type="text" placeholder="Business Name" id="business_name" name="business_name" required>
                    </div>
                    <div class="input-field">
                        <i class="bi bi-buildings"></i>
                        <input type="text" placeholder="Industry" id="industry" name="industry" required>
                    </div>
                    <div class="input-field">
                        <i class="bi bi-envelope"></i>
                        <input type="text" placeholder="Business Email" id="business_email" name="business_email" required>
                    </div>
                    <div class="input-field">
                        <i class="bi bi-telephone"></i>
                        <input type="tel" placeholder="Contact Phone Number" id="telephone" name="telephone" required>
                    </div>
                    
                    <%# 
                    <div class="input-field service-input-container">
                            <i class="bi bi-card-checklist"></i>
                            <input type="text" id="service-input" placeholder="   Add a service">
                            <button type="button" id="add-service">Add</button>
                    </div>
                    <div class="">
                         <div id="services-list" class="services-tags"></div>
                             <!-- Hidden input to store services array -->
                         <input type="hidden" id="services" name="services">
                    </div>
                     %>
                     
                    <div class="input-field">
                        <i class="bi bi-lock"></i>
                        <input type="password" placeholder="password" id="password1" name="password1" required>
                        <i class="bi bi-eye-slash password-toggle" data-target="password1"></i>
                    </div>
                    <div class="input-field">
                        <i class="bi bi-lock-fill"></i>
                        <input type="password" placeholder="Confirm password" id="password2" name="password2" required>
                        <i class="bi bi-eye-slash password-toggle" data-target="password2"></i>
                    </div>
                    
                    <p class="social-text"><input type="checkbox" id="terms" name="terms" required>  I agree to the Terms and Conditions & Privacy Policy</p>

                    <input type="submit" value="Sign up" class="btn solid">
                    
                </form>
            </div>
        </div>

        <div class="panels-container">
            <div class="panel left-panel">
             <div class="content">
                 <h3>New to BookMyExpert?</h3>
                 <p>Join our community of expert Service providers</p>
                 <div class="sign-up-btns">
                 <button class="btn transparent" id="sign-up-business-btn">Sign up Business Account</button>
                 </div>
             </div>
 
            </div>
 
            <div class="panel right-panel">
             <div class="content">
                 <p>Connect with clients from vast places</p>
                 <h3>Karibu to BookMyExpert!</h3>
                 <button class="btn transparent" id="sign-in-btn">Sign in</button>
             </div>
 
            </div>
         </div>
     </div>

    <script> //same script as the landing page.
        document.addEventListener("DOMContentLoaded", function () {
             const sign_in_btn = document.querySelector("#sign-in-btn");
             const sign_up_personal_btn = document.querySelector("#sign-up-personal-btn"); 
             const sign_up_business_btn = document.querySelector("#sign-up-business-btn");
             const container = document.querySelector(".container");
     
             // Detect URL path and apply the corresponding class
             if (window.location.pathname === "/users/register") {
                 container.classList.add("sign-up-personal-mode");
                 console.log("URL detected: /users/register -> Added class: sign-up-personal-mode");
             } else if (window.location.pathname === "/business/register") {
                 container.classList.add("sign-up-business-mode");
                 console.log("URL detected: /business/register -> Added class: sign-up-business-mode");
             }
     
             // Event listeners for button clicks
             sign_up_business_btn.addEventListener("click", () => {
                 container.classList.add("sign-up-business-mode");
                 container.classList.remove("sign-up-mode");
                 console.log("Clicked: Sign up for business");
                 window.history.pushState({}, "", "/business/register"); // Change URL without reloading
             });
     
             sign_in_btn.addEventListener("click", () => {
                 container.classList.remove("sign-up-mode", "sign-up-business-mode");
                 console.log("Clicked: Sign in");
                 window.history.pushState({}, "", "/login"); // Change URL
             });   
         });

         document.addEventListener('DOMContentLoaded', () => {
            const serviceInput = document.getElementById('service-input');
            const addServiceBtn = document.getElementById('add-service');
            const servicesList = document.getElementById('services-list');
            const servicesHidden = document.getElementById('services');
  
             let services = [];
  
            // Add service to the list
            addServiceBtn.addEventListener('click', () => {
                const service = serviceInput.value.trim();
                if (service && !services.includes(service)) {
                    services.push(service);
                    updateServiceDisplay();
                    serviceInput.value = '';
                }
            });
  
             // Remove service when clicking on tag
             servicesList.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-service')) {
                const serviceToRemove = e.target.parentElement.dataset.service;
                services = services.filter(s => s !== serviceToRemove);
                updateServiceDisplay();
                }
            });
  
            // Update the display and hidden input
            function updateServiceDisplay() {
                servicesList.innerHTML = '';
                services.forEach(service => {
                    const tag = document.createElement('span');
                    tag.className = 'service-tag';
                    tag.dataset.service = service;
                    tag.innerHTML = `${service} <span class="remove-service">&times;</span>`;
                    servicesList.appendChild(tag);
                });
    
                 // Update the hidden input with JSON string of services
                servicesHidden.value = JSON.stringify(services);
            }
        });
         
     </script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const toggles = document.querySelectorAll('.password-toggle');
        
        toggles.forEach(toggle => {
            toggle.addEventListener('click', function() {
                // Get the target input field
                const targetId = this.getAttribute('data-target');
                const passwordInput = document.getElementById(targetId);
                
                // Toggle password visibility
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    this.classList.remove('bi-eye-slash');
                    this.classList.add('bi-eye');
                    this.classList.add('active');
                } else {
                    passwordInput.type = 'password';
                    this.classList.remove('bi-eye');
                    this.classList.add('bi-eye-slash');
                    this.classList.remove('active');
                }

                // Add ripple effect
                const ripple = document.createElement('div');
                ripple.classList.add('ripple');
                this.appendChild(ripple);
                
                // Remove ripple after animation
                setTimeout(() => ripple.remove(), 1000);
            });
        });

        // Hide password when user switches tabs/windows
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'hidden') {
                toggles.forEach(toggle => {
                    const targetId = toggle.getAttribute('data-target');
                    const passwordInput = document.getElementById(targetId);
                    
                    // Reset to password type
                    passwordInput.type = 'password';
                    toggle.classList.remove('bi-eye');
                    toggle.classList.add('bi-eye-slash');
                    toggle.classList.remove('active');
                });
            }
        });
    });
    </script>
     
     </body>
     </html>